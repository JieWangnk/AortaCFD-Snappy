{
  "version": "1.0",
  "profile": "RANS-wallfn",
  "description": "Stage 1: Geometry-driven mesh optimization (user-friendly config)",

  "paths": {
    "openfoam_env": "source /opt/openfoam12/etc/bashrc"
  },

  "units": {
    "stl_units": "auto",
    "scale_m": 0.001
  },

  "mesh": {
    "base_size_mode": "diameter",
    "cells_per_diameter": 22,
    "min_cells_per_throat": 28,
    "block_cell_size_m": 0.0001
  },

  "refinement": {
    "surface_levels": [1, 1],
    "near_band_dx": 4,
    "far_band_dx": 10,
    "feature_angle": {
      "mode": "adaptive",
      "init": 45,
      "step": 10
    }
  },

  "layers": {
    "n": 10,
    "expansion": 1.2,
    "first_layer": {
      "mode": "auto_dx",
      "t_over_dx": 0.8,
      "t1_min_frac": 0.02,
      "t1_max_frac": 0.08
    }
  },

  "physics": {
    "solver_mode": "RANS",
    "flow_model": "turbulent",
    "y_plus": 30,
    "U_peak": 1.0,
    "rho": 1060.0,
    "mu": 0.0035,
    "use_womersley_bands": false,
    "heart_rate_hz": 1.2
  },

  "accept": {
    "maxNonOrtho": 65,
    "maxSkewness": 4.0,
    "min_layer_coverage": 0.70
  },

  "compute": {
    "procs": 4,
    "cell_budget_kb_per_cell": 1.0
  },

  "iterations": {
    "max": 3,
    "ladder": [[1,1],[1,2],[2,2]]
  },

  "advanced": {
    "BLOCKMESH": {
      "divisions": null,
      "cell_size_m": 0.0002,
      "min_per_axis": null,
      "grading": [1, 1, 1]
    },

    "SNAPPY": {
      "surface_level": [1, 1],
      "maxLocalCells": 2000000,
      "maxGlobalCells": 8000000,
      "nCellsBetweenLevels": 1,
      "resolveFeatureAngle": 45,
      "nSmoothPatch": 3,
      "nFeatureSnapIter": 10,
      "implicitFeatureSnap": false,
      "explicitFeatureSnap": true
    },

    "LAYERS": {
      "nSurfaceLayers": 10,
      "firstLayerThickness_abs": null,
      "minThickness_abs": 2.0e-5,
      "expansionRatio": 1.2,
      "nGrow": 0,
      "featureAngle": 60,
      "maxThicknessToMedialRatio": 0.3,
      "minMedianAxisAngle": 90
    },

    "MESH_QUALITY": {
      "snap": {
        "maxNonOrtho": 65,
        "maxBoundarySkewness": 4.0,
        "maxInternalSkewness": 4.0,
        "minVol": 1e-13,
        "minTetQuality": -1e15,
        "minFaceWeight": 0.02
      },
      "layer": {
        "maxNonOrtho": 65,
        "maxBoundarySkewness": 4.0,
        "maxInternalSkewness": 4.0,
        "minVol": 1e-13,
        "minTetQuality": 1e-6,
        "minFaceWeight": 0.02
      }
    },

    "SURFACE_FEATURES": {
      "includedAngle": 170
    },

    "GEOMETRY_POLICY": {
      "diameter_mode": "auto",
      "clamp_mode": "none",
      "throat_guard_scale": 0.85,
      "featureAngle_mode": "adaptive",
      "fixed_D_ref_m": null,
      "fixed_D_min_m": null
    },

    "STAGE1": {
      "base_size_mode": "diameter",
      "N_D": 22,
      "N_D_min": 28,
      "cells_per_cm": 12,
      "near_band_cells": 4,
      "far_band_cells": 10,
      "featureAngle_init": 45,
      "featureAngle_step": 10,
      "coverage_target": 0.65,
      "cell_budget_kb_per_cell": 1.0,
      "n_processors": 4,
      "autoFirstLayerFromDx": true,
      "alpha_total_layers": 0.8,
      "t1_min_fraction_of_dx": 0.02,
      "t1_max_fraction_of_dx": 0.08
    },

    "SCALING": {
      "scale_m": 1.0e-3
    },

    "acceptance_criteria": {
      "maxNonOrtho": 65,
      "maxSkewness": 4.0,
      "min_layer_coverage": 0.70
    },

    "PHYSICS": {
      "solver_mode": "RANS",
      "autoFirstLayer": false,
      "U_peak": 1.0,
      "rho": 1060.0,
      "mu": 3.5e-3,
      "y_plus": 1.0,
      "flow_model": "turbulent",
      "use_womersley_bands": false,
      "heart_rate_hz": 1.2
    }
  }
}